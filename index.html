<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8" />
<title>è‚¡ç¥¨æŒ‡æ¨™è§€æ¸¬å¹³å°</title>
<style>
    body {
        font-family: "Segoe UI", sans-serif;
        background: #f5f5f5;
        padding: 20px;
    }
    h2 {
        margin-top: 40px;
        color: #333;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        background: #fff;
        margin-top: 10px;
        border-radius: 8px;
        overflow: hidden;
        table-layout: fixed;  /* å›ºå®šè¡¨æ ¼ä½ˆå±€ï¼Œç¢ºä¿æ¬„ä½å¯¬åº¦ä¸€è‡´ */
    }
    th, td {
        padding: 12px;
        text-align: center;
        border-bottom: 1px solid #eee;
        word-wrap: break-word;  /* é•·æ–‡å­—è‡ªå‹•æ›è¡Œ */
    }
    th {
        background: #4CAF50;
        color: white;
    }
    th:first-child, td:first-child {
        width: 11%;  /* è‚¡ç¥¨å¸‚å ´æ¬„ä½å›ºå®šå¯¬åº¦ */
        font-weight: bold;
    }
    th:nth-child(2), td:nth-child(2) {
        width: 9%;  /* æ”¶ç›¤åƒ¹æ¬„ä½ */
    }
    th:nth-child(3), td:nth-child(3) {
        width: 9%;  /* æ¼²è·Œå¹…æ¬„ä½ */
    }
    th:not(:first-child):not(:nth-child(2)):not(:nth-child(3)), 
    td:not(:first-child):not(:nth-child(2)):not(:nth-child(3)) {
        width: 8%;  /* å…¶ä»–æ¬„ä½å¹³å‡åˆ†é…å‰©é¤˜å¯¬åº¦ */
    }
    /* è¶…è²·è¶…è³£é¡è‰²æ¨™ç¤º */
    .overbought {
        background-color: #ffebee;
        color: #c62828;
        font-weight: bold;
    }
    .oversold {
        background-color: #e8f5e9;
        color: #2e7d32;
        font-weight: bold;
    }
    /* MA è¶¨å‹¢é¡è‰²æ¨™ç¤º */
    .trend-up {
        background-color: #ffebee;
        color: #c62828;
        font-weight: bold;
    }
    .trend-down {
        background-color: #e8f5e9;
        color: #2e7d32;
        font-weight: bold;
    }
    /* æ¼²è·Œå¹…é¡è‰²æ¨™ç¤º */
    .price-up {
        color: #c62828;
        font-weight: bold;
    }
    .price-down {
        color: #2e7d32;
        font-weight: bold;
    }
    /* æ•™å­¸å€å¡Šæ¨£å¼ */
    .tutorial-section {
        margin-top: 60px;
        padding: 30px;
        background: #fff;
        border-radius: 8px;
        line-height: 1.8;
    }
    .tutorial-section h2 {
        color: #333;
        margin-top: 0;
        margin-bottom: 20px;
    }
    .tutorial-section h3 {
        color: #4CAF50;
        margin-top: 30px;
        margin-bottom: 15px;
    }
    .tutorial-section ul {
        margin-left: 20px;
    }
    .tutorial-section li {
        margin-bottom: 8px;
    }
    .tutorial-section .warning {
        color: #f57c00;
        font-weight: bold;
    }
</style>
</head>
<body>

<h1>ğŸ“ˆ è‚¡ç¥¨æŒ‡æ¨™è§€æ¸¬å¹³å°</h1>
<p>æ¯æ—¥è‡ªå‹•æ›´æ–°æ˜¨æ—¥æ”¶ç›¤åƒ¹èˆ‡æŠ€è¡“æŒ‡æ¨™ï¼ˆç”± GitHub Actions è‡ªå‹•ç”Ÿæˆï¼‰</p>

<table id="stock-table">
    <thead>
        <tr>
            <th>è‚¡ç¥¨å¸‚å ´</th>
            <th>æ”¶ç›¤åƒ¹</th>
            <th>ä»Šæ—¥æ¼²è·Œå¹…</th>
            <th>å¸‚ç›ˆç‡ (PE)</th>
            <th>K å€¼</th>
            <th>D å€¼</th>
            <th>RSI</th>
            <th>æœˆç·š (20MA)</th>
            <th>åŠå¹´ç·š (120MA)</th>
            <th>å¹´ç·š (240MA)</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<script>
// è®€å–è‡ªå‹•æ›´æ–°çš„ data.json
fetch("data.json?ts=" + Date.now())      // é¿å… GitHub Cache
  .then(res => {
    if (!res.ok) {
      throw new Error('ç„¡æ³•è¼‰å…¥æ•¸æ“š');
    }
    return res.json();
  })
  .then(data => {
    renderTable(data);
  })
  .catch(error => {
    console.error('è¼‰å…¥æ•¸æ“šå¤±æ•—:', error);
    const tbody = document.querySelector("#stock-table tbody");
    tbody.innerHTML = '<tr><td colspan="10" style="text-align: center; padding: 20px;">ç„¡æ³•è¼‰å…¥æ•¸æ“šï¼Œè«‹ç¨å¾Œå†è©¦</td></tr>';
  });

function renderTable(data) {
    const formatNumber = (num) => num != null ? num.toFixed(1) : 'N/A';
    const tbody = document.querySelector("#stock-table tbody");
    
    // å®šç¾©æ‰€æœ‰è‚¡ç¥¨ï¼ˆæŒ‰é †åºï¼‰
    const stocks = [
        { key: "twii", name: "å°è‚¡åŠ æ¬Š (TWII)" },
        { key: "tsmc", name: "å°ç©é›» (TSMC)" },
        { key: "etf0050", name: "å…ƒå¤§å°ç£50 (0050)" },
        { key: "etf00631l", name: "å…ƒå¤§å°ç£50æ­£2 (00631L)" },
        { key: "etf00675l", name: "å¯Œé‚¦å°50æ­£2 (00675L)" },
        { key: "nasdaq", name: "NASDAQ (IXIC)" },
        { key: "tqqq", name: "ProShares UltraPro QQQ (TQQQ)" },
        { key: "qld", name: "ProShares Ultra QQQ (QLD)" },
        { key: "nvda", name: "NVIDIA (NVDA)" },
        { key: "msft", name: "Microsoft (MSFT)" },
        { key: "goog", name: "Google (GOOG)" },
        { key: "tsla", name: "Tesla (TSLA)" },
        { key: "smh", name: "SMH ETF" },
        { key: "aapl", name: "Apple (AAPL)" },
        { key: "amzn", name: "Amazon (AMZN)" },
        { key: "meta", name: "Meta (META)" },
        { key: "btc", name: "Bitcoin (BTC)" },
        { key: "gld", name: "Gold ETF (GLD)" },
    ];
    
    // åˆ¤æ–·è¶…è²·è¶…è³£çš„å‡½æ•¸
    function getKDClass(k, d) {
        if (k != null && d != null && !isNaN(k) && !isNaN(d)) {
            if (k > 80 || d > 80) return 'overbought';
            if (k < 20 || d < 20) return 'oversold';
        }
        return '';
    }
    
    function getRSIClass(rsi) {
        if (rsi != null && !isNaN(rsi)) {
            if (rsi > 70) return 'overbought';
            if (rsi < 30) return 'oversold';
        }
        return '';
    }
    
    // åˆ¤æ–· MA è¶¨å‹¢çš„å‡½æ•¸
    function getMAClass(close, ma) {
        if (close != null && ma != null && !isNaN(close) && !isNaN(ma)) {
            if (close > ma) return 'trend-up';
            if (close < ma) return 'trend-down';
        }
        return '';
    }
    
    // æ ¼å¼åŒ–æ¼²è·Œå¹…ä¸¦è¿”å›é¡è‰²é¡åˆ¥
    function formatChangePercent(changePercent) {
        if (changePercent == null || isNaN(changePercent)) {
            return { text: 'N/A', class: '' };
        }
        const sign = changePercent >= 0 ? '+' : '';
        const text = `${sign}${changePercent.toFixed(1)}%`;
        const className = changePercent >= 0 ? 'price-up' : 'price-down';
        return { text, class: className };
    }
    
    // æ¸…ç©º tbody é¿å…é‡è¤‡
    tbody.innerHTML = '';
    
    // å‹•æ…‹æ¸²æŸ“æ‰€æœ‰è‚¡ç¥¨è³‡æ–™
    stocks.forEach(stock => {
        const stockData = data[stock.key];
        if (stockData) {
            const kClass = getKDClass(stockData.k, stockData.d);
            const dClass = getKDClass(stockData.k, stockData.d);
            const rsiClass = getRSIClass(stockData.rsi);
            const ma20Class = getMAClass(stockData.close, stockData.ma20);
            const ma120Class = getMAClass(stockData.close, stockData.ma120);
            const ma240Class = getMAClass(stockData.close, stockData.ma240);
            
            // æ ¼å¼åŒ–æ¼²è·Œå¹…
            const changeInfo = formatChangePercent(stockData.change_percent);
            
            // èª¿è©¦ç”¨ï¼ˆå¯åœ¨ç€è¦½å™¨æ§åˆ¶å°æŸ¥çœ‹ï¼‰
            if (kClass || dClass || rsiClass || ma20Class || ma120Class || ma240Class) {
                console.log(`${stock.name}: K=${kClass}, D=${dClass}, RSI=${rsiClass}, MA20=${ma20Class}, MA120=${ma120Class}, MA240=${ma240Class}`);
            }
            
            tbody.innerHTML += `
                <tr>
                    <td>${stock.name}</td>
                    <td>${formatNumber(stockData.close)}</td>
                    <td class="${changeInfo.class}">${changeInfo.text}</td>
                    <td>${stockData.pe != null ? stockData.pe.toFixed(1) : 'N/A'}</td>
                    <td class="${kClass}">${formatNumber(stockData.k)}</td>
                    <td class="${dClass}">${formatNumber(stockData.d)}</td>
                    <td class="${rsiClass}">${formatNumber(stockData.rsi)}</td>
                    <td class="${ma20Class}">${formatNumber(stockData.ma20)}</td>
                    <td class="${ma120Class}">${formatNumber(stockData.ma120)}</td>
                    <td class="${ma240Class}">${formatNumber(stockData.ma240)}</td>
                </tr>
            `;
        }
    });
}
</script>

<div class="tutorial-section">
    <h2>ğŸ“š æŠ€è¡“æŒ‡æ¨™æ•™å­¸</h2>
    
    <h3>1ï¸âƒ£ RSIï¼ˆRelative Strength Indexï¼Œç›¸å°å¼·å¼±æŒ‡æ¨™ï¼‰</h3>
    <p><strong>è¨ˆç®—æ¦‚å¿µï¼š</strong>RSI æ˜¯è¡¡é‡ä¸€æ®µæ™‚é–“å…§åƒ¹æ ¼ä¸Šæ¼²èˆ‡ä¸‹è·Œçš„å¼·å¼±æ¯”ï¼Œé€šå¸¸ç”¨ 14æ—¥ RSIã€‚</p>
    <ul>
        <li>RSI = 100 Ã— (å¹³å‡æ¼²å¹… / (å¹³å‡æ¼²å¹… + å¹³å‡è·Œå¹…))</li>
        <li>å€¼ç¯„åœï¼š0~100</li>
    </ul>
    <p><strong>è§£è®€æ–¹å¼ï¼š</strong></p>
    <ul>
        <li>RSI > 70 â†’ <span class="overbought" style="display: inline-block; padding: 2px 8px;">è¶…è²·</span>ï¼Œè‚¡åƒ¹å¯èƒ½çŸ­æœŸéé«˜ï¼Œéœ€æ³¨æ„å›èª¿</li>
        <li>RSI < 30 â†’ <span class="oversold" style="display: inline-block; padding: 2px 8px;">è¶…è³£</span>ï¼Œè‚¡åƒ¹å¯èƒ½çŸ­æœŸéä½ï¼Œå¯èƒ½å‡ºç¾åå½ˆ</li>
        <li>50 é™„è¿‘ â†’ å¸‚å ´ä¸­æ€§ï¼Œæ²’æœ‰æ˜é¡¯è¶¨å‹¢</li>
    </ul>
    <p class="warning">âš ï¸ æ³¨æ„ï¼šRSI é«˜ä¸ä¸€å®šç«‹åˆ»è·Œï¼ŒRSI ä½ä¹Ÿä¸ä¸€å®šç«‹åˆ»æ¼²ï¼Œå®ƒåå‘è¶¨å‹¢å¼·å¼±åƒè€ƒã€‚</p>
    
    <hr style="margin: 30px 0; border: none; border-top: 1px solid #eee;">
    
    <h3>2ï¸âƒ£ K, D å€¼ï¼ˆéš¨æ©ŸæŒ‡æ¨™ Stochastic Oscillatorï¼‰</h3>
    <p><strong>è¨ˆç®—æ¦‚å¿µï¼š</strong>ç”¨æœ€é«˜åƒ¹ã€æœ€ä½åƒ¹èˆ‡æ”¶ç›¤åƒ¹ä¹‹é–“çš„ä½ç½®ï¼Œè¡¡é‡è‚¡åƒ¹å‹•èƒ½ã€‚</p>
    <ul>
        <li>K = ï¼ˆç•¶æ—¥æ”¶ç›¤åƒ¹ - Næ—¥æœ€ä½åƒ¹ï¼‰ / (Næ—¥æœ€é«˜åƒ¹ - Næ—¥æœ€ä½åƒ¹) Ã— 100</li>
        <li>D = K çš„ N æ—¥ç§»å‹•å¹³å‡</li>
    </ul>
    <p><strong>è§£è®€æ–¹å¼ï¼š</strong></p>
    <ul>
        <li>K æˆ– D > 80 â†’ <span class="overbought" style="display: inline-block; padding: 2px 8px;">è¶…è²·å€</span>ï¼Œå¯èƒ½åè½‰å‘ä¸‹</li>
        <li>K æˆ– D < 20 â†’ <span class="oversold" style="display: inline-block; padding: 2px 8px;">è¶…è³£å€</span>ï¼Œå¯èƒ½åè½‰å‘ä¸Š</li>
        <li>K èˆ‡ D é»ƒé‡‘äº¤å‰ï¼ˆK ä¸Šç©¿ Dï¼‰ â†’ è²·è¨Š</li>
        <li>K èˆ‡ D æ­»äº¡äº¤å‰ï¼ˆK ä¸‹ç©¿ Dï¼‰ â†’ è³£è¨Š</li>
    </ul>
    <p>K, D å°çŸ­æœŸåƒ¹æ ¼å‹•ä½œæ¯”è¼ƒæ•æ„Ÿï¼Œæ¯” RSI æ›´é©åˆæ•æ‰çŸ­ç·šæ³¢å‹•ã€‚</p>
    
    <hr style="margin: 30px 0; border: none; border-top: 1px solid #eee;">
    
    <h3>3ï¸âƒ£ MAï¼ˆMoving Averageï¼Œç§»å‹•å¹³å‡ç·šï¼‰</h3>
    <ul>
        <li>MA20 â†’ 20æ—¥å¹³å‡ç·š â†’ çŸ­æœŸè¶¨å‹¢</li>
        <li>MA120 â†’ 120æ—¥å¹³å‡ç·š â†’ ä¸­æœŸè¶¨å‹¢</li>
        <li>MA240 â†’ 240æ—¥å¹³å‡ç·š â†’ é•·æœŸè¶¨å‹¢</li>
    </ul>
    <p><strong>è§£è®€æ–¹å¼ï¼š</strong></p>
    <ul>
        <li>åƒ¹æ ¼ > MA â†’ <span class="trend-up" style="display: inline-block; padding: 2px 8px;">ä¸Šæ¼²è¶¨å‹¢</span></li>
        <li>åƒ¹æ ¼ < MA â†’ <span class="trend-down" style="display: inline-block; padding: 2px 8px;">ä¸‹è·Œè¶¨å‹¢</span></li>
        <li>MA çŸ­æœŸä¸Šç©¿é•·æœŸ â†’ å¤šé ­è¨Šè™Ÿï¼ˆé»ƒé‡‘äº¤å‰ï¼‰</li>
        <li>MA çŸ­æœŸä¸‹ç©¿é•·æœŸ â†’ ç©ºé ­è¨Šè™Ÿï¼ˆæ­»äº¡äº¤å‰ï¼‰</li>
    </ul>
    <p><strong>æ­é…ä½¿ç”¨ï¼š</strong></p>
    <ul>
        <li>MA20 èˆ‡ MA120/MA240 æ¯”è¼ƒï¼Œå¯çœ‹çŸ­æœŸè¶¨å‹¢èˆ‡ä¸­é•·æœŸè¶¨å‹¢æ˜¯å¦ä¸€è‡´</li>
        <li>ä¾‹å¦‚ï¼šåƒ¹æ ¼çªç ´ MA20 ä¸” MA20 > MA120 â†’ çŸ­æœŸä¸Šæ”»å¯èƒ½å»¶çºŒ</li>
    </ul>
</div>

</body>
</html>
